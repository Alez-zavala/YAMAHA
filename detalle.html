<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle del Producto</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #000000; /* Fondo negro */
            color: #ffffff; /* Color de texto blanco */
            overflow: hidden; /* Evita el scroll debido a la animación */
        }

        header {
            background: linear-gradient(to right, #000000, #001f3f); /* Negro mezclado con azul oscuro */
            color: #ffffff;
            padding: 20px;
            text-align: left;
            font-size: 2.5em;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            letter-spacing: 1px;
            position: relative;
            z-index: 2; /* Asegura que el encabezado esté encima del efecto de Matrix */
        }

        .back-link {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.6em; /* Tamaño más pequeño */
            padding: 2px 5px;
            background-color: #001f3f; /* Azul oscuro para el botón de regreso */
            color: #ffffff; /* Color del texto del botón de regreso */
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .back-link:hover {
            background-color: #000000; /* Negro para el hover */
        }

        .container {
            width: 80%;
            max-width: 800px;
            margin: auto;
            padding: 20px;
            background-color: #000000; /* Fondo negro para el contenedor */
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 2; /* Asegura que el contenido esté encima del efecto de Matrix */
        }

        .carousel {
            position: relative;
            overflow: hidden;
            margin: auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 5px solid #001f3f; /* Borde azul oscuro para el carrusel */
            border-radius: 10px;
            padding: 5px;
            width: 100%;
            max-width: 300px;
            height: 300px; /* Ajusta la altura del carrusel */
            box-shadow: 0 0 15px rgba(0, 31, 63, 0.8);
            animation: neon 6s ease-in-out infinite;
        }

        @keyframes neon {
            0%, 100% {
                box-shadow: 0 0 10px rgba(0, 31, 63, 0.8), 
                            0 0 20px rgba(0, 31, 63, 0.6), 
                            0 0 30px rgba(0, 31, 63, 0.4);
            }
            50% {
                box-shadow: 0 0 20px rgba(0, 31, 63, 1), 
                            0 0 30px rgba(0, 31, 63, 0.9), 
                            0 0 40px rgba(0, 31, 63, 0.7);
            }
        }

        .carousel-inner {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 100%;
            height: 100%;
        }

        .carousel-inner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            flex: 0 0 auto;
            cursor: pointer;
            border: 5px solid #000000; /* Borde blanco para las imágenes */
            box-sizing: border-box; /* Asegura que el borde no afecte el tamaño del contenedor */
        }

        .product-details {
            margin-top: 20px;
        }

        .product-details h1 {
            font-size: 2em;
            color: #ffffff; /* Color del nombre del producto */
        }

        .product-details p {
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .product-details .btn {
            background-color: #001f3f; /* Azul oscuro para el botón de ficha técnica */
            color: #ffffff; /* Color del texto del botón de ficha técnica */
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.3s;
        }

        .product-details .btn:hover {
            background-color: #000000; /* Negro para el hover */
        }

        /* Lightbox styles */
        .lightbox {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 80%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .lightbox img {
            max-width: 100%;
            max-height: 100%;
            border: 5px solid #001f3f;
        }

        .lightbox .close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #001f3f;
            color: #ffffff;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5em;
        }

        .lightbox .controls {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 10px;
            z-index: 1001;
        }
        
        .lightbox .controls button {
            background: #001f3f;
            color: #ffffff;
            border: none;
            padding: 10px;
            border-radius: 5px;
            font-size: 2em;
            cursor: pointer;
        }
        
        .lightbox .controls button:hover {
            background: rgb(0, 0, 0);
        }

        /* Estilo para el canvas de fondo */
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* Asegura que el canvas esté detrás del encabezado y el contenido */
        }
    </style>
</head>
<body>
    <header>
        Detalle del Producto
        <a href="index.html" class="back-link">Inicio</a>
    </header>

    <div class="container">
        <div class="carousel" id="carouselContainer">
            <div class="carousel-inner" id="carouselInner">
                <!-- Las imágenes del carrusel se insertarán aquí -->
            </div>
        </div>

        <div class="product-details">
            <h1 id="productName"></h1>
            <p id="productDescription"></p>
            <p id="productFeatures"></p>
            <p><button class="btn" id="productPdf" onclick="window.open('', '_blank')">Ficha Técnica</button></p>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-content">
            <button class="close" id="closeLightbox">&times;</button>
            <img id="lightboxImage" src="" alt="Imagen del producto">
            <div class="controls">
                <button id="prevLightbox">&#9664;</button>
                <button id="nextLightbox">&#9654;</button>
            </div>
        </div>
    </div>

    <canvas id="matrixCanvas"></canvas>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const params = new URLSearchParams(window.location.search);
            const productId = params.get('productId');
            let products = JSON.parse(localStorage.getItem('products')) || [];

            if (productId && products[productId]) {
                const product = products[productId];
                document.getElementById('productName').textContent = product.name;
                document.getElementById('productDescription').textContent = product.description;
                document.getElementById('productFeatures').textContent = product.features;
                document.getElementById('productPdf').onclick = function() {
                    window.open(product.pdf, '_blank');
                };

                const carouselContainer = document.getElementById('carouselContainer');
                const carouselInner = document.getElementById('carouselInner');

                if (product.additionalImages.length > 0) {
                    product.additionalImages.forEach((url) => {
                        const img = document.createElement('img');
                        img.src = url;
                        img.alt = 'Imagen del producto';
                        img.addEventListener('click', () => openLightbox(url));
                        carouselInner.appendChild(img);
                    });

                    // Carousel animation
                    let currentIndex = 0;
                    const images = carouselInner.querySelectorAll('img');
                    const totalImages = images.length;

                    function showImage(index) {
                        carouselInner.style.transform = `translateX(-${index * 100}%)`; // Ancho de imagen
                    }

                    // Auto-slide
                    setInterval(() => {
                        currentIndex = (currentIndex + 1) % totalImages;
                        showImage(currentIndex);
                    }, 3000); // Cambia la imagen cada 3 segundos

                    // Mostrar solo una imagen a la vez
                    showImage(currentIndex);
                } else {
                    carouselContainer.style.display = 'none';
                }
            }

            function openLightbox(imageSrc) {
                const lightbox = document.getElementById('lightbox');
                const lightboxImage = document.getElementById('lightboxImage');
                const images = document.querySelectorAll('.carousel-inner img');
                lightboxImage.src = imageSrc;
                lightbox.style.display = 'flex';

                // Find index of the image
                let currentIndex = Array.from(images).findIndex(img => img.src === imageSrc);

                function updateLightboxImage(index) {
                    lightboxImage.src = images[index].src;
                }

                document.getElementById('closeLightbox').addEventListener('click', function() {
                    document.getElementById('lightbox').style.display = 'none';
                });

                document.getElementById('prevLightbox').addEventListener('click', function() {
                    currentIndex = (currentIndex - 1 + images.length) % images.length;
                    updateLightboxImage(currentIndex);
                });

                document.getElementById('nextLightbox').addEventListener('click', function() {
                    currentIndex = (currentIndex + 1) % images.length;
                    updateLightboxImage(currentIndex);
                });
            }
        });

        // Configuración del canvas de animación de Matrix en el fondo
        const matrixCanvas = document.getElementById('matrixCanvas');
        const matrixCtx = matrixCanvas.getContext('2d');
        matrixCanvas.width = window.innerWidth;
        matrixCanvas.height = window.innerHeight;

        const matrixCharacters = '01';
        const matrixFontSize = 16;
        const matrixColumns = matrixCanvas.width / matrixFontSize;
        const matrixDrops = Array(Math.floor(matrixColumns)).fill(1);
        let matrixColors = ['#600000', '#000060', '#400040', '#555555']; // Colores más oscuros

        function drawMatrix() {
            matrixCtx.fillStyle = 'rgba(0, 0, 0, 0.05)'; // Suaviza el efecto de "desvanecimiento"
            matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);

            matrixCtx.fillStyle = '#0F0'; // Color de los números
            matrixCtx.font = `${matrixFontSize}px monospace`;

            for (let i = 0; i < matrixDrops.length; i++) {
                const text = matrixCharacters[Math.floor(Math.random() * matrixCharacters.length)];
                const x = i * matrixFontSize;
                const y = matrixDrops[i] * matrixFontSize;

                matrixCtx.fillStyle = matrixColors[Math.floor(Math.random() * matrixColors.length)]; // Color aleatorio
                matrixCtx.fillText(text, x, y);

                if (y > matrixCanvas.height && Math.random() > 0.975) {
                    matrixDrops[i] = 0;
                }

                matrixDrops[i]++;
            }
        }

        function updateMatrixColors() {
            matrixColors = ['#600000', '#000060', '#400040', '#555555']; // Colores más oscuros
        }

        setInterval(updateMatrixColors, 5000); // Cambia los colores cada 5 segundos
        setInterval(drawMatrix, 50); // Redibuja cada 50ms

        window.addEventListener('resize', () => {
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
